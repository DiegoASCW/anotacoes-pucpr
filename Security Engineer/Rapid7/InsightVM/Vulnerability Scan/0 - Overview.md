
InsightVM, em outras palavras, Insight Vulnerability Manager, coleta as vulnerabilidades dos dispositivos por meio do escaneamento destes. Entretanto, esses scans podem ocorrer de 2as formas:
1. Vindo de um coletor/console central;
2. Vindo dos agentes instalados.

Antes de tudo, vale ressaltar que o scan realizado tanto por um agente, ou um console, têm o mesmo fim (encontrar vulnerabilidades), mas somente se diferenciam pela proposta. Enquanto o **console** foca em prover uma visão de um agente externo, e as vulnerabilidades que alguém de fora consegue ver, o **agente** define um visão de quem já está internamente do sistema. Um não é melhor que o outro, apenas diferente.

#### Console
Um console é uma máquina (virtual ou física), dedicada somente para esse fim, e têm por definição 3 itens: Acesso à rede, um banco de dados (Postgresql), e um Scan engine.
O acesso a rede se dá pela necessidade de se comunicar com os dispositivos, e com a plataforma em nuvem da Rapid7 para poder compartilhar seus resultados.
O B.D é necessário para armazenar temporariamente os seus achados, antes de enviar à nuvem.
Scan engine é quem torna possível a verificação de vulnerabilidades, ou seja, é quem faz o scan propriamente dito.

Ter só um console com uma só scan engine para milhares de computadores parece um processo demorado, até porquê é, e nesse caso você pode instalar diversos scan engines espalhados pelo ambiente, e cada um fará seu scan e enviará os resultados ao Console, agilizando assim o processo como um todo. No entanto, outra forma de agilizar as buscas, é a criação de uma "piscina de scans", ou seja, um conglomerado de scans que dividem entre si a carga recebida.

#### Agente
Um agente, podendo ser o InsightIDR, por exemplo, é instalado em cada dispositivo, e realiza seu próprio scan individual. Este não depende do coletor para enviar dado à nuvem.


OBS: O envio de dados para a nuvem se dá pela porta 443.

---
### Sobre o SCAN
Como já sabemos, o InsightVM opera coletando informações dos dispositivos, por meio de scan de um console central, ou de agentes instalados nas máquinas. Cada um com suas devidas propriedades.

Entretanto, devemos saber como esse scan funciona, para fins de melhor entendimento do resultado final, e de seu processo. Sendo então, divido em 6 fases:

1. Asset Discovery
2. Service Discovery
3. OS Fingerprint
4. Vulnerability checks
5. Policy checks
6. Integration


[[InsightVM]]